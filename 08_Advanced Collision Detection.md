# Advanced Collision Detection
---------------------------------
## Tuning Shape Collision Behavior
-----------------------------------
用于产生接触的`Shape`会影响它们通过接触点(Contact point)附着(attached)的dynamic rigid bodies。约束求解器在接触点处产生脉冲力，以保持`Shape`静止或移动而不相互传递。`Shape`有两个重要参数，用于控制碰撞检测如何生成它们之间的接触点，而这些接触点又是碰撞或堆叠(stacking)时它们行为的核心： `contactOffset` 和 `restOffset` 。它们分别使用`PxShape::setContactOffset（）`和`PxShape::setRestOffset（）`进行设置。这两个值都不直接使用。碰撞检测始终对一对可能碰撞的`Shape`进行操作，并且始终考虑两个`Shape`的偏移总和。我们分别称这些为"contactDistance"和"restDistance"。

碰撞检测能够在两个`Shape`之间产生接触点，当它们仍然相距很远时，当它们完全接触时，或者当它们相互穿透时。为了使讨论更简单，我们将相互渗透视为负距离。因此，两个`Shape`之间的距离可以是正数、零形或负数。 `SeparationDistance` 是碰撞检测开始生成接触的距离。它必须大于零，这意味着当两个`Shape`穿透时， `PhysX` 将始终生成触点（除非以某种方式完全禁用了两个`Shape`之间的碰撞检测，例如过滤）。默认情况下，在 `PxTolerancesScale` 中使用公制单位和默认缩放时， `contactOffset` 为 0.02，这意味着 `contactDistance` 的计算值将达到 4 厘米。因此，当两个`Shape`在4厘米内彼此接近时，将产生触点，直到它们再次移动到4厘米以外的距离。

然而，接触点的产生并不意味着会立即在这些位置施加大脉冲来分离`Shape`，甚至阻止在穿透方向上进一步运动。除非将仿真时间步长选择为很小，否则这将使仿真抖动变小，这对于实时性能是不可取的。相反，我们希望接触处的力随着穿透力的增加而平滑增加，直到它达到足够高的值以阻止任何进一步的穿透运动。达到最大力的距离是静止距离，因为在这个距离上，相互堆叠的两个`Shape`将达到静态平衡并静止。当`Shape`由于某种原因被推在一起，以至于它们的距离低于静止时，会施加更大的力将它们推开，直到它们再次处于静止距离。随着距离的变化而施加的力的变化不一定是线性的，但它是平滑和连续的，即使在大的时间步长下也能产生令人愉悦的模拟。

在为`Shape`选择 `contactOffset` 和 `restOffset` 时，需要考虑一些不同的事项。通常，相同的值可用于模拟中的所有`Shape`。首先确定 `restOffset` 是有意义的。目标通常是使图形`Shape`看起来堆叠在一起，使它们完全接触，就像现实生活中的身体一样。如果碰撞`Shape`的大小与图形`Shape`的大小完全相同，则需要 `restOffset` 为零。如果碰撞`Shape`的 epsilon 大于图形`Shape`，则负 epsilon 的 `restOffset` 是正确的。这将使较大的碰撞`Shape`相互下沉，直到较小的图形`Shape`也接触。rest大于零的偏移是实际的，例如，如果在三角形几何体上滑动时存在问题，其中基于穿透的接触生成比分离接触点更难以产生平滑的接触点，从而导致更平滑的滑动。

确定 `restOffset` 后，应选择触点关闭集的值稍大一些。经验法则是使两者之间的差异尽可能小，从而在仿真使用的时间步长大时仍能有效避免抖动。较大的时间步长需要更大的差异。将其设置得太大的缺点是，当两个`Shape`接近时，将更快地生成触点，这会增加仿真必须担心的触点总数。这将降低性能。此外，仿真代码通常假设接触点靠近凸形的表面。如果接触偏移非常大，则此假设会崩溃，从而导致行为伪影。

## Contact Modification
--------------------------

